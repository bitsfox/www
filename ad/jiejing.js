var treeX=130,treestat="o";function SetTreeWidth(){var B=document.getElementById("openflag");if(B==null)return;var _=document.getElementById("treemenu"),A=document.getElementById("left"),$=document.getElementById("middle");if(treestat=="o"&&treeX<130){_.style.display="";treeX+=30;setTimeout("SetTreeWidth()",30)}else if(treestat=="c"&&treeX>12){_.style.display="";treeX-=30;setTimeout("SetTreeWidth()",30)}else if(treestat=="o"){_.style.display="";treeX=130;B.innerHTML="<img src=\"/img/close.gif\" onclick=\"TreeOpenClose('c')\">";writeCookie("strf",treestat);resizePano()}else if(treestat=="c"){treeX=12;_.style.display="none";B.innerHTML="<img src=\"/img/open.gif\" onclick=\"TreeOpenClose('o')\">";writeCookie("strf",treestat);resizePano()}B.style.left=(treeX-8)+"px";A.style.width=treeX+"px";$.style.margin="0px 0px 0px "+treeX+"px"}function TreeOpenClose($){treestat=$;SetTreeWidth()}function initflag(){var $=readCookie("strf");if($=="")$="o";TreeOpenClose($)}var map,pano,panoClient=new GStreetviewClient(),marker=null;function init(){var P=d(mstr),E=P.split("_");if(E.length!=8)return;var I=0,$=parseFloat(E[I++]),H=parseFloat(E[I++]),M=parseInt(E[I++]),_=parseFloat(E[I++]),O=parseFloat(E[I++]),D=parseFloat(E[I++]),F=parseFloat(E[I++]),A=parseInt(E[I++]),L=document.getElementById("map");map=new GMap2(L);map.disableDoubleClickZoom();map.enableScrollWheelZoom();map.addControl(new GSmallZoomControl());map.setMapType(G_SATELLITE_MAP);GEvent.addListener(map,"click",function($,_){panoClient.getNearestPanorama(_,updataPano)});var C=document.getElementById("pano");pano=new GStreetviewPanorama(C);GEvent.addListener(pano,"error",handlePanoError);GEvent.addListener(pano,"initialized",handlePanoInitialized);GEvent.addListener(pano,"yawchanged",onYawChange);var K=new GLatLng($,H);map.setCenter(K,M);map.addOverlay(new GStreetviewOverlay());var J=new GLatLng(_,O),N=new GIcon(G_DEFAULT_ICON);N.image="http://maps.gstatic.com/mapfiles/cb/man_arrow-0.png";N.transparent="http://maps.gstatic.com/mapfiles/cb/man-pick.png";N.imageMap=[26,13,30,14,32,28,27,28,28,36,18,35,18,27,16,26,16,20,16,14,19,13,22,8];N.iconSize=new GSize(49,52);N.iconAnchor=new GPoint(25,35);N.infoWindowAnchor=new GPoint(25,5);marker=new GMarker(J,{icon:N,draggable:true});map.addOverlay(marker);GEvent.addListener(marker,"dragend",function($){panoClient.getNearestPanorama($,updataPano)});var B={yaw:D,pitch:F,zoom:A};pano.setLocationAndPOV(J,B);if(document.all)C.attachEvent("onresize",resizePano);else window.addEventListener("resize",resizePano,false);var G=document.getElementById("progress");G.style.display="none";initflag()}function onYawChange(A){var _=16,$=360/_;if(A<0)A+=360;guyImageNum=Math.round(A/$)%_;guyImageUrl="http://maps.gstatic.com/mapfiles/cb/man_arrow-"+guyImageNum+".png";marker.setImage(guyImageUrl)}function resizePano(){pano.checkResize()}function handlePanoInitialized($){}function handlePanoError($){if($==603){alert("\u63d0\u793a: \u60a8\u7684\u6d4f\u89c8\u5668\u65e0\u6cd5\u663e\u793aflash\uff0c\u8bf7\u91cd\u65b0\u5b89\u88c5flash\u63d2\u4ef6\uff0c\u624d\u80fd\u6b63\u786e\u89c2\u770b\u5b9e\u666f");return}else if($==600){alert("\u63d0\u793a: \u6b64\u5904\u6ca1\u6709\u5b9e\u666f\u56fe\uff0c\u8bf7\u5355\u51fb\u5730\u56fe\u91cd\u65b0\u9009\u62e9\u5730\u70b9");return}}function updataPano($){if($.code!=200){alert("\u63d0\u793a: \u6b64\u5904\u6ca1\u6709\u5b9e\u666f\u56fe\uff0c\u8bf7\u5355\u51fb\u5728\u84dd\u8272\u7ebf\u5305\u56f4\u7684\u8857\u9053\u4e0a");return}pano.setLocationAndPOV($.location.latlng);marker.setLatLng($.location.latlng)}function d(str){var mmm="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcde",a1,a2,a3,b=mmm,d=0,t,a;if(str.charAt(0)=="z"){t=new Array(Math.floor((str.length-1)/2));a=t.length;for(var x=0;x<a;x++){d++;a2=b.indexOf(str.charAt(d));d++;a3=b.indexOf(str.charAt(d));t[x]=a2*41+a3}}else{t=new Array(Math.floor(str.length/3));a=t.length;for(x=0;x<a;x++){a1=b.indexOf(str.charAt(d));d++;a2=b.indexOf(str.charAt(d));d++;a3=b.indexOf(str.charAt(d));d++;t[x]=a1*1681+a2*41+a3}}a=eval("String.fromCharCode("+t.join(",")+")");return a}if(document.all){window.attachEvent("onload",init);window.onunload=GUnload}else{window.addEventListener("load",init,false);window.addEventListener("unload",GUnload,false)}
